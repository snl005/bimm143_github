---
title: "Class 09: Structural Bioinformatics"
author: "Le, Sarah NDH (PID: A18518276)"
format: html
toc: TRUE
---

## The PDB database

The main database for structural biology is called the PDB. Let's have a look at what it contains:

Download a CSV file from the PDB site (accessible from “Analyze” > “PDB Statistics” > “by Experimental Method and Molecular Type”. 

```{r pdbstats, message= FALSE}
library(readr)
stats <- read_csv("Data Export Summary.csv")
stats
```

> Q1: What percentage of structures in the PDB are solved by X-Ray and Electron Microscopy. Give your answers to 2 significant figures.

```{r}
n.total <- sum(stats$Total)
```

```{r}
n.xray <- sum(stats$`X-ray`)
percent.xray <- n.xray / n.total *100
percent.xray
```

There are `r round(percent.xray, 2)` percent Xray structures in the PDB


```{r}
n.EM <- sum(stats$EM)
percent.EM <- n.EM / n.total *100
percent.EM
```

There are `r round(percent.EM, 2)` percent Xray structures in the PDB


> Q2: What proportion of structures in the PDB are protein?

```{r}
round(stats$Total[1]/n.total *100,2)

```

## Exploring PDB structures

> Q3: Type HIV in the PDB website search box on the home page and determine how many HIV-1 protease structures are in the current PDB?

Over 100 HIV-protease structures in the current PDB. 

> Q4: Water molecules normally have 3 atoms. Why do we see just one atom per water molecule in this structure?

Because Hydrogens are not visible as they are relatively small in most structures due to limited resolution.

> Q5: There is a critical “conserved” water molecule in the binding site. Can you identify this water molecule? What residue number does this water molecule have?

We can identify this water molecule as it is the one that bridges 2 Asp25 residues. The residue number that this water molecule has is HOH 308.

Package for structural bioinformatics

```{r}
library(bio3d)
hiv <- read.pdb("1hsg")
hiv
```

> Q7: How many amino acid residues are there in this pdb object?

There are 198 amino acid residues in this PDB object. 

> Q8: Name one of the two non-protein residues?

MK1 (ligand) is one of the two non-protein residues, and the other one is HOH (water).

> Q9: How many protein chains are in this structure? 

There are 2 protein chains in this structure. 

Let's first use the Mol* viewer to explore this structure. 

![My first view of HIV-Pr](1HSG.png)

> Q6: Generate and save a figure clearly showing the two distinct chains of HIV-protease along with the ligand. You might also consider showing the catalytic residues ASP 25 in each chain and the critical water (we recommend “Ball & Stick” for these side-chains). Add this figure to your Quarto document.

![](1HSG 2.png)

## PDB objects in R

```{r}
head(hiv$atom)
```

Extract the sequence

```{r}
pdbseq(hiv)
```

```{r}
chainA_seq <- pdbseq(trim.pdb(hiv, chain= "A"))
```

I can interactively view these PDB objects in R with the new **bio3dview** package. This is not yet on CRAN.

To install this I can setup **pak** package and use it to install **bio3dview** from GitHub. In my console, I first run:

pak::pak("bioboot/bio3dview")
install.packages("NGLVieweR")

```{r, message= FALSE}
library(bio3dview)

view.pdb(hiv)
```
Change some settings

```{r}
sel <- atom.select(hiv, resno=25)

view.pdb(hiv, highlight= sel,
         highlight.style = "spacefill",
         colorScheme = "chain",
         col= c("blue", "orange"), 
         backgroundColor= "pink")
```

## Predict protein flexibility

We can run a bioinformatics calculation to predict protein dynamics - i.e. functional motions.

We will use the `nma()` function:

```{r}
adk <- read.pdb("6s36")
adk
```

```{r}
m <- nma(adk)
plot(m)
```

Generate a "trajectory" of predicted motion

```{r}
mktrj(m, file= "ADK_nma.pdb")
```

```{r}
view.nma(m)
```

